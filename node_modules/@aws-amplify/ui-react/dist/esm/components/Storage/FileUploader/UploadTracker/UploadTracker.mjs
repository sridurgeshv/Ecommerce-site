import e,{useCallback as i}from"react";import{translate as t,humanFileSize as m}from"@aws-amplify/ui";import{FileState as r}from"../types.mjs";import"../../../../primitives/Alert/Alert.mjs";import"../../../../primitives/Autocomplete/Autocomplete.mjs";import"../../../../primitives/Badge/Badge.mjs";import"../../../../primitives/Breadcrumbs/Breadcrumbs.mjs";import{Button as s}from"../../../../primitives/Button/Button.mjs";import"../../../../primitives/ButtonGroup/ButtonGroup.mjs";import"../../../../primitives/Card/Card.mjs";import"../../../../primitives/CheckboxField/CheckboxField.mjs";import"../../../../primitives/Collection/Collection.mjs";import"../../../../primitives/Divider/Divider.mjs";import"../../../../primitives/DropZone/DropZone.mjs";import"../../../../primitives/Expander/Expander.mjs";import"../../../../primitives/Expander/ExpanderItem.mjs";import"../../../../primitives/FieldGroupIcon/FieldGroupIcon.mjs";import"../../../../primitives/FieldGroupIcon/FieldGroupIconButton.mjs";import"../../../../primitives/Fieldset/Fieldset.mjs";import"../../../../primitives/Fieldset/useFieldset.mjs";import"../../../../primitives/Flex/Flex.mjs";import"../../../../primitives/Grid/Grid.mjs";import"../../../../primitives/Heading/Heading.mjs";import"../../../../primitives/HighlightMatch/HighlightMatch.mjs";import"../../../../primitives/Icon/Icon.mjs";import"../../../../primitives/Icon/context/IconsContext.mjs";import"tslib";import"classnames";import{ComponentClassNames as l}from"../../../../primitives/shared/constants.mjs";import{View as o}from"../../../../primitives/View/View.mjs";import{IconClose as a}from"../../../../primitives/Icon/icons/IconClose.mjs";import{IconEdit as p}from"../../../../primitives/Icon/icons/IconEdit.mjs";import{IconFile as n}from"../../../../primitives/Icon/icons/IconFile.mjs";import{Image as c}from"../../../../primitives/Image/Image.mjs";import"../../../../primitives/Input/Input.mjs";import"../../../../primitives/Label/Label.mjs";import"../../../../primitives/Link/Link.mjs";import{Loader as d}from"../../../../primitives/Loader/Loader.mjs";import"../../../../primitives/Menu/Menu.mjs";import"../../../../primitives/Menu/MenuButton.mjs";import"../../../../primitives/Menu/MenuItem.mjs";import"../../../../primitives/Message/Message.mjs";import"../../../../primitives/Pagination/Pagination.mjs";import"../../../../primitives/PasswordField/PasswordField.mjs";import"../../../../primitives/PhoneNumberField/PhoneNumberField.mjs";import"../../../../primitives/Placeholder/Placeholder.mjs";import"../../../../primitives/Radio/Radio.mjs";import"../../../../primitives/RadioGroupField/RadioGroupField.mjs";import"../../../../primitives/Rating/Rating.mjs";import"../../../../primitives/ScrollView/ScrollView.mjs";import"../../../../primitives/SearchField/SearchField.mjs";import"../../../../primitives/SelectField/SelectField.mjs";import"../../../../primitives/SliderField/SliderField.mjs";import"../../../../primitives/StepperField/StepperField.mjs";import"../../../../primitives/SwitchField/SwitchField.mjs";import"../../../../primitives/Table/Table.mjs";import"../../../../primitives/Table/TableBody.mjs";import"../../../../primitives/Table/TableCell.mjs";import"../../../../primitives/Table/TableFoot.mjs";import"../../../../primitives/Table/TableHead.mjs";import"../../../../primitives/Table/TableRow.mjs";import"../../../../primitives/Tabs/Tabs.mjs";import{Text as u}from"../../../../primitives/Text/Text.mjs";import"../../../../primitives/TextAreaField/TextAreaField.mjs";import{TextField as v}from"../../../../primitives/TextField/TextField.mjs";import"../../../../primitives/ToggleButton/ToggleButton.mjs";import"../../../../primitives/ToggleButtonGroup/ToggleButtonGroup.mjs";import{VisuallyHidden as j}from"../../../../primitives/VisuallyHidden/VisuallyHidden.mjs";import{UploadMessage as F}from"./UploadMessage.mjs";function E({errorMessage:E,file:g,fileState:f,hasImage:I,name:T,onCancel:b,onCancelEdit:S,onPause:h,onResume:x,onSaveEdit:C,onStartEdit:R,percentage:G,isResumable:N,showImage:B}){const[M,k]=e.useState(T),w=e.useRef(null),U=URL.createObjectURL(g);e.useEffect((()=>{f===r.EDITING&&w.current&&w.current.focus()}),[f]);const{size:L}=g,z=I?e.createElement(c,{alt:g.name,src:U}):e.createElement(n,null),D=!N||G>0,P=f===r.INIT||f===r.ERROR&&E===t("Extension not allowed"),A=i((()=>e.createElement(e.Fragment,null,e.createElement(o,{className:l.FileUploaderFileMain},e.createElement(u,{className:l.FileUploaderFileName},T)),P?e.createElement(s,{onClick:R,size:"small",variation:"link"},e.createElement(j,null,"Edit file name ",g.name),e.createElement(p,{"aria-hidden":!0,fontSize:"medium"})):null,e.createElement(u,{as:"span",className:l.FileUploaderFileSize},m(L,!0)))),[g.name,T,R,P,L]),H=i((()=>{switch(f){case r.EDITING:return e.createElement(e.Fragment,null,e.createElement(s,{size:"small",onClick:()=>{k(T),null==S||S()}},"Cancel"),e.createElement(s,{size:"small",variation:"primary",onClick:()=>{C(M)}},"Save"));case r.RESUME:case r.LOADING:return N?e.createElement(s,{onClick:h,size:"small",variation:"link"},t("pause")):null;case r.PAUSED:return e.createElement(s,{onClick:x,size:"small",variation:"link"},t("Resume"));case r.SUCCESS:return null;default:return e.createElement(s,{size:"small",onClick:b},e.createElement(j,null,"Remove file name ",g.name),e.createElement(a,{"aria-hidden":!0,fontSize:"medium"}))}}),[g.name,f,N,T,b,S,h,x,C,M]);return g?e.createElement(o,{className:l.FileUploaderFile},e.createElement(o,{className:l.FileUploaderFileWrapper},B?e.createElement(o,{className:l.FileUploaderFileImage},z):null,f===r.EDITING?e.createElement(o,{as:"form",flex:"1",onSubmit:()=>{C(M)}},e.createElement(v,{maxLength:1024,ref:w,label:"file name",size:"small",variation:"quiet",labelHidden:!0,onChange:e=>{k(e.target.value)},value:M})):e.createElement(A,null),e.createElement(H,null),f===r.LOADING?e.createElement(d,{className:l.FileUploaderLoader,variation:"linear",percentage:G,isDeterminate:D,isPercentageTextHidden:!0}):null),e.createElement(F,{fileState:f,errorMessage:E,percentage:G})):null}export{E as UploadTracker};

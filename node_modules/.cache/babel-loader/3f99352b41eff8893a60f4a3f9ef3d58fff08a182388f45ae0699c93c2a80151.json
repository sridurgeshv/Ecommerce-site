{"ast":null,"code":"import React,{useState,useContext}from'react';import{AuthenticationDetails,CognitoUser}from'amazon-cognito-identity-js';import{useNavigate,Link}from'react-router-dom';import UserPool from'../../UserPool';import UserContext from'../../contexts/UserContext';import'./login.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[errorMessage,setErrorMessage]=useState('');const navigate=useNavigate();const{setProfile}=useContext(UserContext);const onSubmit=e=>{e.preventDefault();const user=new CognitoUser({Username:username,Pool:UserPool});const authDetails=new AuthenticationDetails({Username:username,Password:password});user.authenticateUser(authDetails,{onSuccess:result=>{console.log('login success',result);const userProfile={username:result.idToken.payload['cognito:username']// Add any other relevant user data from the result object\n};setProfile(userProfile);// Set the user profile in the context\nnavigate('/');// Navigate to the home page\n},onFailure:err=>{console.log('login failure',err);setErrorMessage('Incorrect username or password. Please try again.');// Set error message\n},newPasswordRequired:data=>{console.log('new password required',data);}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[\"Username:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:e=>setUsername(e.target.value)}),/*#__PURE__*/_jsx(\"br\",{}),\"Password:\",/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value)}),/*#__PURE__*/_jsx(\"br\",{}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errorMessage}),\" \",/*#__PURE__*/_jsx(\"button\",{className:\"signin\",type:\"submit\",children:\"Login\"}),/*#__PURE__*/_jsx(Link,{to:\"/register\",children:/*#__PURE__*/_jsx(\"button\",{className:\"signup\",children:\"Signup\"})})]})]});};export default Login;","map":{"version":3,"names":["React","useState","useContext","AuthenticationDetails","CognitoUser","useNavigate","Link","UserPool","UserContext","jsx","_jsx","jsxs","_jsxs","Login","username","setUsername","password","setPassword","errorMessage","setErrorMessage","navigate","setProfile","onSubmit","e","preventDefault","user","Username","Pool","authDetails","Password","authenticateUser","onSuccess","result","console","log","userProfile","idToken","payload","onFailure","err","newPasswordRequired","data","className","children","type","value","onChange","target","to"],"sources":["/workspace/Ecommerce-site/src/components/auth/login.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { AuthenticationDetails, CognitoUser } from 'amazon-cognito-identity-js';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport UserPool from '../../UserPool';\r\nimport UserContext from '../../contexts/UserContext';\r\nimport './login.css';\r\n\r\nconst Login = () => {\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const navigate = useNavigate();\r\n  const { setProfile } = useContext(UserContext);\r\n\r\n  const onSubmit = (e) => {\r\n    e.preventDefault();\r\n    const user = new CognitoUser({ Username: username, Pool: UserPool });\r\n    const authDetails = new AuthenticationDetails({ Username: username, Password: password });\r\n\r\n    user.authenticateUser(authDetails, {\r\n      onSuccess: (result) => {\r\n        console.log('login success', result);\r\n        const userProfile = {\r\n          username: result.idToken.payload['cognito:username'],\r\n          // Add any other relevant user data from the result object\r\n        };\r\n        setProfile(userProfile); // Set the user profile in the context\r\n        navigate('/'); // Navigate to the home page\r\n      },\r\n      onFailure: (err) => {\r\n        console.log('login failure', err);\r\n        setErrorMessage('Incorrect username or password. Please try again.'); // Set error message\r\n      },\r\n      newPasswordRequired: (data) => {\r\n        console.log('new password required', data);\r\n      },\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"login\">\r\n      <h2>Login</h2>\r\n      <form onSubmit={onSubmit}>\r\n        Username:\r\n        <input type=\"text\" value={username} onChange={(e) => setUsername(e.target.value)} />\r\n        <br />\r\n        Password:\r\n        <input type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} />\r\n        <br />\r\n        {errorMessage && <p className=\"error-message\">{errorMessage}</p>} {/* Display error message if exists */}\r\n        <button className=\"signin\" type=\"submit\">Login</button>\r\n        <Link to=\"/register\">\r\n          <button className=\"signup\">Signup</button>\r\n        </Link>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}